/*
 * movement.c
 *
 *  Created on: Apr 24, 2025
 *      Author: adamhwu, jpyong
 */

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include "main.h"
#include "motors.h"
#include "values.h"

int move_dist(float dist) {
	int direction = (dist > 0) ? 1 : 0;
	SetLMotorDirection(direction);
	SetRMotorDirection(direction);
	TIM2->CCR4 = fabsf(mouseSpeed);
	TIM2->CCR3 = fabsf(mouseSpeed);

	while (encLmm < dist) {
		continue;
	}

	TIM2->CCR3 = fabsf(0);
	TIM2->CCR4 = fabsf(0);

	return 0;
}

int find_bias() {
	int num = 0;
	SetLMotorDirection(1);
	SetRMotorDirection(1);
	while (encLmm == 0){
		num = num + 10;
		TIM2->CCR3 = fabsf(num);
		HAL_Delay(500);
	}
	TIM2->CCR4 = fabsf(0);
	return num;
}

void turn180() { //won't work long term, encLmm updates with every movement
	int flag;
	SetLMotorDirection(1);
	SetRMotorDirection(0);
	TIM2->CCR4 = fabsf(mouseSpeed);
	TIM2->CCR3 = fabsf(mouseSpeed);
	while (encLmm < 85) { //from 0 to ~85 is about the value of encLmm that ensures the mouse does as 180
		flag = 1;
	}
	flag = 0;
	TIM2->CCR4 = fabsf(0);
	TIM2->CCR3 = fabsf(0);
}
